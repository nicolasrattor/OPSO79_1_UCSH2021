---
title: "OPSO79-1-UCSH2021"
subtitle: "Introducci√≥n a la ciencia abierta, RMarkdown y herramientas de gesti√≥n bibliogr√°fica"
date: "`01 de octubre 2021`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: [xaringan-themer.css]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
library(pagedown)
library(tidyverse)


dark_yellow <- "#EFBE43"
light_yellow <- "#FDF7E9"
gray <- "#333333"
blue <- "#4466B0"

style_duo(
  # colors
  primary_color = light_yellow,
  secondary_color = dark_yellow,
  header_color = gray,
  text_color = gray,
  code_inline_color = colorspace::lighten(gray),
  text_bold_color = colorspace::lighten(gray),
  link_color = blue,
  title_slide_text_color = blue,

  # fonts
  header_font_google = google_font("Martel", "300", "400"),
  text_font_google = google_font("Lato"),
  code_font_google = google_font("Fira Mono")
)
```

```{r echo=FALSE,include=FALSE}
#library(pagedown)
#pagedown::chrome_print("clase3b.html")

```


```{r, load_refs, include=FALSE, cache=FALSE}
library(RefManageR)
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "authoryear",
           style = "markdown",
           hyperlink = "to.bib",
           dashed = FALSE)
bib <- ReadBib("bib/openscience.bib", check = FALSE)
```

class: inverse, center, middle

# Ciencia abierta

## Introducci√≥n y desaf√≠os en sociolog√≠a

---

# Introducci√≥n

*"La informaci√≥n es poder. Pero como con todo poder, hay quienes lo quieren mantener para s√≠ mismos. La herencia cient√≠fica y cultural del mundo completa, publicada durante siglos en libros y journals, est√° siendo digitalizada y apresada en forma creciente por un manojo de corporaciones privadas (...)"*.

--

*"(...) Es tiempo de salir a la luz y en la gran tradici√≥n de la desobediencia civil, declarar nuestra oposici√≥n a este robo privado de la cultura p√∫blica (...) Necesitamos tomar la informaci√≥n, donde sea que est√© guardada, hacer nuestras copias y compartirlas con el mundo"*

--

.right[`r Cite(bib, "Swartz2008")`]

--

```{r, out.width = "15%", fig.pos="h", fig.align="right", echo=FALSE, fig.link="https://www.youtube.com/watch?v=VBkD04z-8V8"}
knitr::include_graphics("imagenes/aaswartz.jpg")
```


---

# Introducci√≥n

Esta concepci√≥n de ciencia abierta de Aaron Swartz (accesibilidad) es probablemente la que nos es m√°s cercana. 

--

Inspir√≥ a muchos y muchas. A una de ellas probablemente la han escuchado (y s√≠ no es as√≠ deber√≠an). 

--

.pull-left[La cient√≠fica Alexandra Elbakyan ha creado un [repositorio y p√°gina web (sci-hub)](https://sci-hub.se/) pirata de m√°s de 84 millones de art√≠culos acad√©micos, consiguiendo en la pr√°ctica un acceso abierto a las publicaciones cient√≠ficas.

Por esto se ha ganado varias demandas. En algunos pa√≠ses se encuentra bloqueada (e.g. Alemania)]

```{r, out.width = "30%", fig.pos="h", fig.align="right", echo=FALSE, fig.link="https://es.wikipedia.org/wiki/Alexandra_Elbakyan"}
knitr::include_graphics("imagenes/alexandra.jpg")
```


---

# Introducci√≥n

En paralelo a la opci√≥n "guerrillera", otras l√≠neas institucionales han avanzado. 

--

.pull-left[
```{r, out.width = "80%", echo=FALSE, fig.link="https://doaj.org/"}
knitr::include_graphics("imagenes/doaj.jpg")
```
]

.pull-right[
```{r, out.width = "80%", echo=FALSE, fig.link="https://creativecommons.cl/tipos-de-licencias/"}
knitr::include_graphics("imagenes/ccommons.png")
```
]

--

Pero la ciencia abierta no es solo el acceso libre a art√≠culos y libros.

--

Ciencia abierta es un concepto "paraguas", que cubre diferentes usos. Reflexiones pueden agruparse a lo menos en cinco "escuelas" `r Cite(bib, "Fecher2014")` o cuatro "dimensiones" `r Cite(bib, "Breznau2021")`.

---

# Dimensiones o escuelas de la ciencia abierta (I)

--

## Open access (acceso abierto) o Escuela democr√°tica

Los resultados de la investigaci√≥n cient√≠fica deben ser accesibles a todos/as, removiendo las barreras de pago de las revistas. 

--

Es justo por el uso de fondos p√∫blicos.

--

Es racional por que la ciencia se basa en la acumulaci√≥n progresiva de conocimiento (nos paramos sobre hombres de gigantes), ¬øComo construir investigaci√≥n de calidad sin revisar lo producido por otros/as?

--

**Posibles salidas:** Publicar en revistas open access, liberar prepints, difundir y cooperar en expandir el repositorio sci-hub/lig-gen, sabotaje a grandes revistas, redireccionar el uso de fondos de las universidades, etc.  


---

# Derivaci√≥n de acceso abierto seg√∫n la Escuela de la Medici√≥n

--

Cr√≠tica a las medidas de productividad y a la permanente obligaci√≥n por publicar (podr√≠a sacrificar la calidad de la misma ciencia)

--

La contribuci√≥n de la ciencia debe ser medida con indicadores de impactos alternativos. 

--

+ El proceso de revisi√≥n de pares consume demasiado tiempo (la misma comunidad cient√≠fica deber√≠a evaluar)

--

+ El impacto de los art√≠culos est√° m√°s relacionado a la revista que directamente al art√≠culo (importa m√°s el poder simb√≥lico que el argumento)

--

+ Existen nuevos formtos de publicaci√≥n (blogs, revistas online con acceso abierto), que pocas veces tienen un formato de revista al que se le puede asignar un factor de impacto. 


---

# Dimensiones de la ciencia abierta (II)

## Open process (transparencia)

--

Se deben dar a conocer todos los m√©todos, c√≥digos, data y conflictos de inter√©s antes y despu√©s de que la investigaci√≥n sea realizada.

--

Siempre que el hacerlo no da√±e seres humanos ni viole leyes (*e.g. anonimato informantes*).

--

Permite la sinergia entre investigadores, previniendo la duplicaci√≥n de recolecciones y an√°lisis de datos. 

--

Permite discusi√≥n m√°s transparente y continuar o expandir proyectos de investigaci√≥n de terceros. 

--

La creaci√≥n de conocimiento puede ser m√°s eficiente si los cient√≠ficos trabajan en conjunto (Escuela pragm√°tica). Problemas complejos requieren esfuerzos combinados. 

--

**Posibles salidas:** Preregistro de investigaciones (*OSF*), publicaci√≥n de c√≥digos y data (*github y otros repositorios*), Investigaci√≥n Reproducible.


---

# Dimensiones de la ciencia abierta (III)

## Open source (c√≥digo abierto)

--

Todos los programas, apps, algoritmos, herramientas y scripts deben ser transparentes y usables por otros. 

--

Cuando un cient√≠fico desarrolla una nueva tecnolog√≠a, cualquier tecnolog√≠a de otro puede interactuar con esta.

--

Cualquiera puede modificar la tecnolog√≠a para adoptarlas mejor a sus propias necesidades

--

**R y sus paquetes van en esta l√≠nea**. 


---

# Dimensiones de la ciencia abierta (IV)

## Open academia o Escuela P√∫blica

--

Todos/as pueden participar de la academia. Las desigualdades el mundo social deben ser eliminadas del mundo acad√©mico. 

--

Incluso, las cs. podr√≠an tener el objetivo de eliminar las desigualdades del mundo social (e.g. sociolog√≠a p√∫blica de `r Cite(bib, "Burawoy2005")`:

--

+ Intervenir en discusiones p√∫blicas o elaboraci√≥n de pp.

--

+ Apoyar la organizaci√≥n de movimientos sociales. 

--

Debiese importar el argumento y la evidencia, no el poder o posici√≥n de los actores. 

--

Desaf√≠o de la comunicaci√≥n de los resultados de la investigaci√≥n, ¬øbasta con liberar el *paper*?. 

--

L√≠neas innovadoras de involucrar a la ciudadan√≠a [(citzen science)](https://www.zooniverse.org/about).


---

# ¬øPor qu√© ciencia abierta en sociolog√≠a?

--

Principal camino para evitar su fracaso como disciplina cient√≠fica `r Cite(bib, "Breznau2021")`.

--

Permite resolver la actual crisis de legitimidad en la que se encuentran las ciencias sociales:

--

+ Poca confianza desde el p√∫blico y de quienes hacen las pol√≠ticas p√∫blicas

--

+ Esc√°ndalos por profesores que construyeron su carrera en base a falsa evidencia

--

+ Activistas que publicaron premeditadamente "basura" en prestigiosas revistas [(Sokal Squared" scandal)](https://www.youtube.com/watch?v=kVk9a5Jcd1k).

--

En mundo cuantitativo:

+ *p hacking*: correr modelos una y otra vez hasta que los resultados den significativos. Solo se hace p√∫blico el modelo final [(Una posible salida es modelar "curvas de especificaci√≥n")](https://crowdid.hypotheses.org/220). 

+ Valor *p* como objetivo, pero no dice nada sobre si el modelo est√° mal especificado, sobre la teor√≠a o sobre el tama√±o de los efectos.


---

# ¬øPor qu√© ciencia abierta en sociolog√≠a?

--

Las pretensiones de la ciencia abierta est√°n en las concepciones de ciencia de algunos de los principales referentes de la sociolog√≠a, como [Merton](https://sciencepolicy.colorado.edu/students/envs_5110/merton_sociology_science.pdf) y Habermas. 

--

+ **Universalismo:** pretensiones de verdad, cualquiera sea la fuente, deben ser evaluadas con criterios impersonales preestablecidos. No importan atributos de sus protagonistas. 

--

+ **Comunismo:** Los hallazgos sustantivos de la ciencia son producto de la colaboraci√≥n social. La propiedad intelectual debe limitarse al reconocimiento y estima. 

--

+ **Desinter√©s:** curiosidad, altruismo en la b√∫squeda de beneficiar a la humanidad, y compromiso por la verdad. Rechazo a la acumulaci√≥n de prestigio y a la subordinaci√≥n a grupos de inter√©s fuera del campo. 

--

+ **Escepticismo organizado:** escrutinio peri√≥dico de las creencias en t√©rminos l√≥gicos y emp√≠ricos. Potencial conflicto con actitudes e instituciones sociales. No existe la divisi√≥n entre lo sagrado y lo profano. 

--

+ Cuando la esfera p√∫blica est√° mercantilizada, hay una producci√≥n y consumo de **comunicaci√≥n asim√©trica** (sesgo de contenidos y de acceso a calidad)


---

# Desaf√≠os y problemas de la ciencia abierta

--

+ Acci√≥n directa de recuperaci√≥n de literatura es ilegal.

--

+ La apertura nunca puede ser total: dilemas √©ticos y pol√≠ticos, y restricciones legales.

--

+ Aparente limitaci√≥n a los enfoques cuantitativos de las ciencias sociales (*misconception*).

--

+ Cr√≠tica de As√∫n:

  + Ciencia abierta tiene pretensiones positivistas, si no se cumple nuestro modelo no publicamos.
  + Si se sincera el proceso de manipulaci√≥n de datos y ajuste de modelos (proceso iterativo) nadie nos creer√≠a (e.g. Cop√©rnico). 
  
--

*"No debe ser un movimiento positivista. Es un movimiento para abrir la caja negra que rodea lo que hacen los soci√≥logos, sea lo que sea, para crear una comunidad de control de calidad y di√°logo."* `r Cite(bib, "Breznau2021")`.

---

class: inverse, center, middle

# Investigaci√≥n reproducible

## Apertura de los procesos de investigaci√≥n social

---

# Investigaci√≥n reproducible

--

Que otra persona (o mi yo del futuro) pueda ejecutar mi .pur[c√≥digo] con .pur[los mismos datos] llegando **al mismo resultado**.

--

```{r fig.align='center', out.width = "60%", echo=FALSE, fig.link="https://the-turing-way.netlify.app/reproducible-research/overview/overview-definitions.html"}
knitr::include_graphics("imagenes/reproducible_turing_way.PNG")
```

--

*‚ÄúHere is everything you need to reproduce my work.‚Äù *

*‚ÄúRead the README file for further instructions.‚Äù* 

`r Cite(bib, "Christensen2019")`.

---

# Investigaci√≥n reproducible

![](https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/reproducibility_court.png)

---

# Investigaci√≥n reproducible

## ¬øQue cosas pueden dificultar la reproducci√≥n de un procesamiento y an√°lisis de datos?

--

- No s√© si estoy usando los mismos datos (*problemas de acceso, diferentes versiones*)

--

- Rutas a archivos que son incorrectas

--

- Aleatoriedad no reproducible

--

- Comentarios escuetos en el c√≥digo (*no se entienden las decisiones*)

--

- Variables no localizadas (no estaban creadas en la rutina)

--

- Diferentes versiones del *software* o de los paquetes

---

# Investigaci√≥n reproducible

## Posibles soluciones

--

.pull-left[

- No s√© si estoy usando los mismos datos

&nbsp;&nbsp;&nbsp; üëâ &nbsp;&nbsp;&nbsp; .medium-par[.pur[**Script, Control de versiones**]]


- Rutas a archivos que son incorrectas

&nbsp;&nbsp;&nbsp; üëâ &nbsp;&nbsp;&nbsp; .medium-par[.pur[**RProject, RMarkdown**]]


- Aleatoriedad no reproducible

&nbsp;&nbsp;&nbsp; üëâ &nbsp;&nbsp;&nbsp; .medium-par[.pur[**Fijar semillas con set.seed()**]]

]


.pull-right[

- Comentarios escuetos en el c√≥digo

&nbsp;&nbsp;&nbsp; üëâ &nbsp;&nbsp;&nbsp; .medium-par[.pur[**Orden y estilo de c√≥digo**]]


- Variables no localizadas

&nbsp;&nbsp;&nbsp; üëâ &nbsp;&nbsp;&nbsp; .medium-par[.pur[**RMarkdown**]]


- Diferentes versiones del *software* o de los paquetes

&nbsp;&nbsp;&nbsp; üëâ &nbsp;&nbsp;&nbsp; .medium-par[.pur[**sessionInfo() y paquetes**]]

]

---

# Importancia de la reproducibilidad (Daniela Ballari)

--

+ Recordar como se hizo lo que se hizo (yo del futuro y supervisi√≥n)

--

+ Facilita la detecci√≥n de errores antes de publicar (si el c√≥digo no corre es porque hay problemas)

--

+ Permite el control de versiones (volver al pasado)

--

+ Facilita la continuaci√≥n del trabajo ante el recambio de personal

--

+ Permite la colaboraci√≥n y transparencia del proyecto

--

+ Credibilidad de lo realizado

--

+ Evita malos entendidos, confusiones frente a revisi√≥n o solicitudes innecesarias (cualquier duda consulta el c√≥digo)

--

+ C√≥digo puede reutilizarse o complejizarse para mejorar un procedimiento o una investigaci√≥n



---

class: inverse, center, middle

# RMarkdown

## Articulaci√≥n de c√≥digo y texto para la reproducibilidad

---

# Breve repaso de RMarkdown 
```{r fig.align='center', out.width = "10%", echo=FALSE}
knitr::include_graphics("https://www.rstudio.com/wp-content/uploads/2017/05/rmarkdown.png")
```


--

Articulaci√≥n de lenguaje R y texto plano. 

--

Los documentos creados con R Markdown son completamente reproducibles.

--

Si intentamos renderizar un documento, y el proceso falla, no hay reproducci√≥n:

--

+ Se requieren objetos (data frames, vectores) que no han sido creados todav√≠a

--

+ Se intentan cargar bases de datos o im√°genes desde rutas que no existen

--

+ Problemas en la escritura de c√≥digo (confusi√≥n entre mayusc y minusc, guiones bajos)

--

+ Problemas en el orden del c√≥digo (primero se espcifica modelo y luego se crean las variables)

---

# Breve repaso de RMarkdown 

Si el c√≥digo se reproduce, tenemos un indicador de la calidad de una investigaci√≥n social (primer filtro).

--

Otras cuestiones sustantivas (buenas ideas, revisi√≥n exhaustiva de antecedentes, validez de las mediciones, justificaci√≥n de decisiones, gram√°tica, etc.)

--

Los archivos de `R Markdown` en general tienen 3 partes:

--

(1). Un encabezado que permite configurar inicialmente el documento que vamos a escribir (**yaml**)


![](https://smac-group.github.io/ds/images/rmd_yaml.png)

---

# Breve repaso de RMarkdown 

(2). "Pedazos de c√≥digo" (o en ingl√©s, ***chunk codes***, shortcut `ctrl+alt+i`).

--

![](https://smac-group.github.io/ds/images/rmd_code_chunk.png)

---

# Breve repaso de RMarkdown 

Los chunks tienen muchos argumentos que permiten moldear el output a lo que deseamos.

--

Existe un chunk llamado por defecto "setup" (general para todos los chunks del documento).

--

```
{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


--

Podemos agregar opciones [(detalle ac√°)](https://rmarkdown.rstudio.com/lesson-3.html):

- include = FALSE/TRUE
- echo = FALSE/TRUE
- message = FALSE/TRUE
- warning = FALSE/TRUE
- error = FALSE/TRUE

--

O especificar opciones para cada chunk:

```
{r message=FALSE, warning=FALSE}
library(dplyr)
```


---

# Breve repaso de RMarkdown 

(3). Los **cuerpos de texto** donde podemos hacer comentarios sin necesidad de usar "#" (a diferencia de un script)

--

![](imagenes/rmd_text.PNG)

---

# Breve repaso de RMarkdown 

Podemos crear t√≠tulos (#), √©nfasis con negrita o cursiva, listas de elementos, agregar im√°genes y enlaces.

--

Existe el c√≥digo R "en l√≠nea" (*in line*), lo que nos permite hacer reportes autom√°ticos:

--

El d√≠a de hoy es `r Sys.Date()` y el valor de 5 por 2 es `r 5*10`

--

```{r eval=FALSE}
El d√≠a de hoy es `r Sys.Date()` y el valor de 5 por 2 es `r 5*10`
```

--

Para generar el documento se puede utilizar el comando `render` o bien utilizar el bot√≥n `Knit` (Tejer).

```{r fig.align='center', out.width = "20%", echo=FALSE}
knitr::include_graphics("https://d33wubrfki0l68.cloudfront.net/eb48bae40b24285c0c8f281e6d2a7500cf3b9fc8/a2e5f/knitr/images/knit-logo.png")
```

--

O podemos ir ejecutando l√≠neas de c√≥digo en espec√≠fico, chunks particulares o `Run All`, lo que nos permite detectar errores cuando el c√≥digo no corre. 


---

# De RMarkdown a otros formatos

![](https://lh6.googleusercontent.com/xlpPZilu2MS1EtyS9B6ykhmw4VhAHGaf_ryfg1Ek0_ZqVowztxK8HdMDDvskAM0Rc0vaATajSuLnyQWmtVTaQlw82SvsUQZn8sNAwd03n8O_kr05JUrysSqAY_-tSo-xdrysRFt9BU4)


--

.pull-left[

```
---
title: "T√≠tulo"
author: "Autor"
output: 
  html_document:
---
```
]

.pull-right[

```
---
title: "T√≠tulo"
author: "Autor"
output: 
 pdf_document:
---
```
]

---

# Documentos en formato html

Descargar [formato html](https://github.com/nicolasrattor/formatos/raw/main/Formato%20html/documento.Rmd) estilizado.

Descargar [formato html distill](https://raw.githubusercontent.com/nicolasrattor/formatos/main/Formato%20html%20distill/Paper.Rmd). Para ocupar instalar paquete `distill`. 

---

# Documentos en formato pdf

Descargar [formato pdf](https://github.com/nicolasrattor/formatos/blob/main/Formato%20pdf%20uch/Paper.Rmd). Para utilizarlo se requiere instalar latex: `install.packages('tinytex')` [(m√°s informaci√≥n ac√°)](https://bookdown.org/yihui/rmarkdown/installation.html)


---

# Documentos en formato word

Descargar [formato word](https://github.com/nicolasrattor/formatos/blob/main/Formato%20word/Paper.Rmd). No utilizar en este curso. 


---

# Formato presentaciones

Uso completamente opcional en presentaci√≥n de final de semestre. 

--

Es recomendable ya que evita exportar gr√°ficos y tablas trabajadas en RMarkdown. 

--

Tres formas diferentes

--

+ ioslides

+ Beamer

.pull-left[

+ [Xaringan](https://bookdown.org/yihui/rmarkdown/xaringan-start.html)

]

.pull-right[
```{r echo=FALSE, out.width="20%"}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/b/be/Sharingan_triple.svg")
```
]

--

La tercera es la m√°s simple, tiene varios formatos y solo hay que manejar un par de marcas extras. No es necesario saber latex. 

---

# Recordatorio de elementos a considerar al trabajar en Rmarkdown

--

- La funci√≥n `setwd()` no funciona dentro de RMarkdown (por eso trabajamos con RProject).

- Las librer√≠as que necesiten deben estar cargadas en el script de 
  Rmarkdown (**error habitual**).

- Tanto las bases de datos como las variables a utilizar deben estar
  llamadas dentro el script de Rmarkdown.

- Knitr() incluye la impresi√≥n de los resultados, por lo que no 
  es necesario usar print().

- No usar View() en RMarkdown, porque en el output no mostrar√° nada.

- Cada chunk puede tener o no tener un nombre. Si los deciden nombrar, 
  los nombres NO DEBEN REPETIRSE


---

# Dar formato a las tablas

Funci√≥n `kable()` y paquete `kableExtra()`.

--

```{r}
Orange %>% head(4) #<<
```
--

```{r}
library(knitr) #<<
Orange %>% head(4) %>% kable()  #<<
```


---

# Dar formato a las tablas

```{r warning=FALSE}
library(kableExtra) #<<
Orange %>% head(4) %>% kable(caption = "T√≠tulo de tabla") %>%
 kable_styling(bootstrap_options = c("striped", "hover"))

```

--

Para m√°s informaci√≥n sobre distintos estilos revisar [Create Awesome HTML Table with knitr::kable and kableExtra](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html)

---

# Otras herramientas para la investigaci√≥n reproducible

<https://github.com/>

<https://sci-hub.se/>

<https://osf.io/> o <https://zenodo.org/>

[Zotero](https://www.zotero.org/)

<https://www.researchgate.net/>

<http://www.shinyapps.org/apps/TransparencyChecklist/>

---

# Material de texto y audiovisual de inter√©s

Curso ["Ciencia Social Abierta"](https://cienciasocialabierta.netlify.app/) de Juan Carlos Castillo (en espa√±ol). 

[¬øPor qu√© es importante la reproducibilidad computacional?](https://www.youtube.com/watch?v=Hvrb2b7v93w) De Daniela Ballari. En espa√±ol

[The Story of Aaron Swartz](https://www.youtube.com/watch?v=VBkD04z-8V8). Documental con subt√≠tulos en espa√±ol.

[Como escribir manuscritos reproducibles.](https://www.youtube.com/watch?v=TKhV3w467RI&t=202s) De Francisco Rodr√≠guez-S√°nchez. En espa√±ol

---

# Bibliograf√≠a y elementos consultados

```{r refs, echo=FALSE, results="asis"}
PrintBibliography(bib)
```

[Xaringan: Presentation Ninja, de Yihui Xie](https://github.com/yihui/xaringan). Para generar esta presentaci√≥n.

--
